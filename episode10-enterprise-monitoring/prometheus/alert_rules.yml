groups:
  - name: app_alerts
    rules:
      - alert: WebAppErrorRateHigh
        expr: increase(app_errors_total{job="web"}[1m]) > 0
        for: 30s
        labels:
          severity: critical
        annotations:
          description: "Web service errors detected on {{ $labels.instance }}"

      - alert: ApiErrorRateHigh
        expr: increase(app_errors_total{job="api"}[1m]) > 0
        for: 30s
        labels:
          severity: warning
        annotations:
          description: "API service errors detected on {{ $labels.instance }}"

      - alert: DatabaseHighConnections
        expr: pg_stat_activity_count{datname="devops"} > 50
        for: 1m
        labels:
          severity: critical
        annotations:
          description: "Database connection count exceeded safe limit."

      - alert: InstanceDown
        expr: up == 0
        for: 30s
        labels:
          severity: critical
        annotations:
          description: "Instance {{ $labels.instance }} of job {{ $labels.job }} is down"
